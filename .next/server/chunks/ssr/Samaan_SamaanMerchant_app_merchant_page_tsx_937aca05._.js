module.exports=[43839,a=>{"use strict";var b=a.i(90939),c=a.i(23984),d=a.i(29939),e=a.i(79590),f=a.i(2277),g=a.i(32799),h=a.i(37262);let i=(0,h.default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var j=a.i(31872),k=a.i(27714),l=a.i(65706),m=a.i(46704),n=a.i(18807),o=a.i(87659);let p=(0,h.default)("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);var q=a.i(1797),r=a.i(26920),s=a.i(18134);function t({merchant:a,todayOrders:d,weekOrders:h,lowStockProducts:t,pendingOrders:u,allOrders:v,userEmail:w}){let[x,y]=(0,c.useState)(!1);(0,c.useEffect)(()=>{y(!0)},[]);let z=d.reduce((a,b)=>a+Number(b.total_amount),0),A=u.length,B=t.length,C=new Date;C.setDate(C.getDate()-1);let D=C.toISOString().split("T")[0],E=h.filter(a=>a.created_at.startsWith(D)).reduce((a,b)=>a+Number(b.total_amount),0),F=E>0?(z-E)/E*100:0,G={};v.forEach(a=>{a.items&&Array.isArray(a.items)&&a.items.forEach(a=>{G[a.product_id]?G[a.product_id].count+=a.quantity:G[a.product_id]={name:a.name,count:a.quantity}})});let H=Object.values(G).sort((a,b)=>b.count-a.count).slice(0,5),I=Array.from({length:7},(a,b)=>{let c=new Date;return c.setDate(c.getDate()-(6-b)),c.toISOString().split("T")[0]}),J=I.map(a=>h.filter(b=>b.created_at.startsWith(a)).reduce((a,b)=>a+Number(b.total_amount),0)),K=Math.max(...J,1),L={new:"border-l-blue-500 bg-blue-50/50",confirmed:"border-l-amber-500 bg-amber-50/50",packed:"border-l-purple-500 bg-purple-50/50",ready:"border-l-green-500 bg-green-50/50"},M={new:"New",confirmed:"Confirmed",packed:"Packed",ready:"Ready"};return(0,b.jsxs)("div",{className:(0,s.cn)("space-y-6 pb-24 lg:pb-6 transition-opacity duration-500",x?"opacity-100":"opacity-0"),children:[(0,b.jsx)("div",{className:"flex flex-col gap-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Welcome back!"}),(0,b.jsx)("span",{className:"text-2xl",children:"ðŸ‘‹"})]}),(0,b.jsxs)("p",{className:"text-gray-500",children:["Here's what's happening with"," ",(0,b.jsx)("span",{className:"font-medium text-gray-700",children:a?.shop_name||"your shop"})," today."]})]}),(0,b.jsx)(r.Button,{asChild:!0,className:"bg-gradient-to-r from-[#FF7F32] to-[#ea580c] hover:from-[#ea580c] hover:to-[#d95513] text-white rounded-xl shadow-lg shadow-orange-100 h-11 px-5 touch-active",children:(0,b.jsxs)(e.default,{href:"/merchant/products/new",children:[(0,b.jsx)(g.Package,{className:"w-4 h-4 mr-2"}),"Add Product"]})})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 stagger-children",children:[(0,b.jsxs)(q.Card,{className:"p-4 sm:p-5 bg-white rounded-2xl border-0 shadow-sm card-hover",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-100",children:(0,b.jsx)(f.ShoppingCart,{className:"w-6 h-6 text-white"})}),(0,b.jsx)("span",{className:"text-xs font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded-full",children:"Today"})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-gray-900 animate-count",children:d.length}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Orders"})]})]}),(0,b.jsxs)(q.Card,{className:"p-4 sm:p-5 bg-white rounded-2xl border-0 shadow-sm card-hover",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center shadow-lg shadow-green-100",children:(0,b.jsx)(i,{className:"w-6 h-6 text-white"})}),0!==F&&(0,b.jsxs)("span",{className:(0,s.cn)("text-xs font-medium px-2 py-1 rounded-full flex items-center gap-0.5",F>0?"text-green-600 bg-green-50":"text-red-600 bg-red-50"),children:[F>0?(0,b.jsx)(o.ArrowUpRight,{className:"w-3 h-3"}):(0,b.jsx)(p,{className:"w-3 h-3"}),Math.abs(F).toFixed(0),"%"]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsxs)("p",{className:"text-3xl font-bold text-gray-900 animate-count",children:["â‚¹",z.toLocaleString("en-IN")]}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Revenue"})]})]}),(0,b.jsxs)(q.Card,{className:"p-4 sm:p-5 bg-white rounded-2xl border-0 shadow-sm card-hover",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-500 to-amber-600 rounded-xl flex items-center justify-center shadow-lg shadow-amber-100",children:(0,b.jsx)(l.Clock,{className:"w-6 h-6 text-white"})}),A>0&&(0,b.jsxs)("span",{className:"relative flex h-3 w-3",children:[(0,b.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),(0,b.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-amber-500"})]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-gray-900 animate-count",children:A}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Pending"})]})]}),(0,b.jsxs)(q.Card,{className:(0,s.cn)("p-4 sm:p-5 rounded-2xl border-0 shadow-sm card-hover",B>0?"bg-gradient-to-br from-red-50 to-white":"bg-white"),children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsx)("div",{className:(0,s.cn)("w-12 h-12 rounded-xl flex items-center justify-center shadow-lg",B>0?"bg-gradient-to-br from-red-500 to-red-600 shadow-red-100":"bg-gradient-to-br from-gray-400 to-gray-500 shadow-gray-100"),children:(0,b.jsx)(j.AlertTriangle,{className:"w-6 h-6 text-white"})}),B>0&&(0,b.jsx)("span",{className:"text-xs font-medium text-red-600 bg-red-100 px-2 py-1 rounded-full",children:"Alert"})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-gray-900 animate-count",children:B}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Low Stock"})]})]})]}),(0,b.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Pending Orders"}),A>0&&(0,b.jsxs)("span",{className:"bg-amber-100 text-amber-700 text-xs font-semibold px-2 py-1 rounded-full",children:[A," active"]})]}),(0,b.jsxs)(e.default,{href:"/merchant/orders",className:"text-[#FF7F32] text-sm font-medium hover:underline flex items-center gap-1 group",children:["View all",(0,b.jsx)(m.ArrowRight,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]})]}),0===u.length?(0,b.jsxs)(q.Card,{className:"p-8 sm:p-12 bg-white rounded-2xl border-0 shadow-sm text-center",children:[(0,b.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-50 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)(f.ShoppingCart,{className:"w-10 h-10 text-gray-300"})}),(0,b.jsx)("h3",{className:"font-semibold text-gray-900 text-lg",children:"No pending orders"}),(0,b.jsx)("p",{className:"text-gray-500 mt-1 max-w-xs mx-auto",children:"New orders will appear here. Make sure your shop is open!"})]}):(0,b.jsx)("div",{className:"space-y-3 stagger-children",children:u.slice(0,5).map(a=>{let c,d;return(0,b.jsx)(e.default,{href:`/merchant/orders/${a.id}`,children:(0,b.jsx)(q.Card,{className:(0,s.cn)("p-4 bg-white rounded-xl border-0 shadow-sm border-l-4 card-hover cursor-pointer touch-active",L[a.status]),children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsxs)("span",{className:"font-bold text-gray-900",children:["#",a.id.slice(0,8).toUpperCase()]}),(0,b.jsx)("span",{className:(0,s.cn)("text-xs font-semibold px-2.5 py-1 rounded-full","new"===a.status&&"bg-blue-100 text-blue-700","confirmed"===a.status&&"bg-amber-100 text-amber-700","packed"===a.status&&"bg-purple-100 text-purple-700","ready"===a.status&&"bg-green-100 text-green-700"),children:M[a.status]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-1 font-medium",children:a.customer_name}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-0.5",children:(c=new Date(a.created_at),(d=Math.floor((new Date().getTime()-c.getTime())/6e4))<1?"Just now":d<60?`${d}m ago`:d<1440?`${Math.floor(d/60)}h ago`:c.toLocaleDateString())})]}),(0,b.jsxs)("div",{className:"text-right shrink-0",children:[(0,b.jsxs)("p",{className:"font-bold text-gray-900 text-lg",children:["â‚¹",Number(a.total_amount).toLocaleString("en-IN")]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[a.items?.length||0," items"]})]})]})})},a.id)})})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(q.Card,{className:"p-5 bg-white rounded-2xl border-0 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:"Revenue Trend"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Last 7 days"})]}),(0,b.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center shadow-lg shadow-green-100",children:(0,b.jsx)(k.TrendingUp,{className:"w-5 h-5 text-white"})})]}),(0,b.jsx)("div",{className:"flex items-end gap-1.5 h-20",children:J.map((a,c)=>(0,b.jsx)("div",{className:"flex-1 flex flex-col items-center gap-1",children:(0,b.jsx)("div",{className:(0,s.cn)("w-full rounded-t-lg transition-all duration-300",c===J.length-1?"bg-gradient-to-t from-[#FF7F32] to-[#ea580c]":"bg-gradient-to-t from-orange-200 to-orange-100"),style:{height:`${Math.max(a/K*100,4)}%`},title:`â‚¹${a.toFixed(0)}`})},c))}),(0,b.jsx)("div",{className:"flex justify-between mt-3 text-[10px] text-gray-400 font-medium",children:I.map((a,c)=>(0,b.jsx)("span",{children:new Date(a).toLocaleDateString("en-IN",{weekday:"short"}).charAt(0)},c))})]}),(0,b.jsxs)(q.Card,{className:"p-5 bg-white rounded-2xl border-0 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:"Low Stock"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Items need restocking"})]}),(0,b.jsx)(e.default,{href:"/merchant/products?filter=low-stock",className:"text-[#FF7F32] text-xs font-medium hover:underline",children:"View all"})]}),0===t.length?(0,b.jsxs)("div",{className:"text-center py-6",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-green-50 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,b.jsx)(n.Sparkles,{className:"w-6 h-6 text-green-500"})}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"All products well stocked!"})]}):(0,b.jsx)("div",{className:"space-y-3",children:t.slice(0,4).map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3 group",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-xl overflow-hidden shrink-0",children:a.image_url?(0,b.jsx)("img",{src:a.image_url||"/placeholder.svg",alt:a.name,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,b.jsx)(g.Package,{className:"w-5 h-5 text-gray-400"})})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-[#FF7F32] transition-colors",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-red-600 font-semibold",children:[a.stock," left"]})]})]},a.id))})]}),(0,b.jsxs)(q.Card,{className:"p-5 bg-white rounded-2xl border-0 shadow-sm",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:"Top Selling"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Best performers"})]})}),0===H.length?(0,b.jsxs)("div",{className:"text-center py-6",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,b.jsx)(k.TrendingUp,{className:"w-6 h-6 text-gray-400"})}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"No sales data yet"})]}):(0,b.jsx)("div",{className:"space-y-3",children:H.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:(0,s.cn)("w-8 h-8 rounded-lg flex items-center justify-center text-xs font-bold",0===c&&"bg-amber-100 text-amber-700",1===c&&"bg-gray-100 text-gray-600",2===c&&"bg-orange-100 text-orange-700",c>2&&"bg-gray-50 text-gray-500"),children:c+1}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[a.count," sold"]})]})]},c))})]})]})]})]})}var u=a.i(29287),v=a.i(7757);function w(){let a=(0,d.useRouter)(),[e,f]=(0,c.useState)(!0),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)([]),[s,w]=(0,c.useState)("");return((0,c.useEffect)(()=>{(async()=>{try{let b=(0,u.getUser)();if(console.log("[v0] User data from localStorage:",b),!b)return void a.push("/merchant/login");w(b.email||"");let c=b.merchantId||b.merchant_id||b.id;console.log("[v0] Using merchantId:",c);try{let a=await u.merchantsAPI.getById(c);console.log("[v0] Merchant data:",a),h(a)}catch(a){console.log("[v0] Could not fetch merchant data:",a)}try{let a=await u.ordersAPI.getMerchantOrders();console.log("[v0] Orders:",a);let b=new Date;b.setHours(0,0,0,0);let c=(a||[]).filter(a=>new Date(a.createdAt||a.created_at)>=b);j(c);let d=new Date;d.setDate(d.getDate()-7);let e=(a||[]).filter(a=>new Date(a.createdAt||a.created_at)>=d).map(a=>({created_at:a.createdAt||a.created_at,total_amount:a.totalAmount||a.total_amount}));l(e);let f=["new","confirmed","packed","New","Confirmed","Packed"],g=(a||[]).filter(a=>f.includes(a.status)).slice(0,5).map(a=>({...a,id:a.id,status:a.status?.toLowerCase(),customer_name:a.customer?.fullName||a.customerName||a.customer_name,total_amount:a.grandTotal||a.totalAmount||a.total_amount,created_at:a.createdAt||a.created_at,items:a.items||a.orderItems}));p(g),r((a||[]).map(a=>({items:a.items||a.orderItems})))}catch(a){console.log("[v0] Could not fetch orders:",a)}try{let a=await u.productsAPI.getByMerchant(c);console.log("[v0] Products:",a);let b=(a||[]).filter(a=>a.stock<=10&&(a.isActive||a.is_active)).map(a=>({...a,image_url:a.imageUrl||a.image_url,is_active:a.isActive||a.is_active}));n(b)}catch(a){console.log("[v0] Could not fetch products:",a)}}catch(a){console.error("[v0] Error fetching dashboard data:",a)}finally{f(!1)}})()},[a]),e)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(v.Loader2,{className:"w-8 h-8 animate-spin text-[#FF7F32] mx-auto"}),(0,b.jsx)("p",{className:"mt-2 text-gray-500",children:"Loading dashboard..."})]})}):(0,b.jsx)(t,{merchant:g,todayOrders:i,weekOrders:k,lowStockProducts:m,pendingOrders:o,allOrders:q,userEmail:s})}a.s(["default",()=>w],43839)}];

//# sourceMappingURL=Samaan_SamaanMerchant_app_merchant_page_tsx_937aca05._.js.map