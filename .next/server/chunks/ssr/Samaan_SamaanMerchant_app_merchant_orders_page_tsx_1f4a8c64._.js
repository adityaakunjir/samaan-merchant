module.exports=[29623,a=>{"use strict";var b=a.i(90939),c=a.i(23984),d=a.i(29939),e=a.i(29287),f=a.i(26920),g=a.i(1797),h=a.i(35492),i=a.i(5985),j=a.i(2277),k=a.i(65706),l=a.i(96954),m=a.i(32799),n=a.i(25404),o=a.i(54408),p=a.i(89277),q=a.i(37262);let r=(0,q.default)("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),s=(0,q.default)("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);var t=a.i(46704),u=a.i(5607),v=a.i(92070),w=a.i(21581);let x=(0,q.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var y=a.i(68426),z=a.i(18134);let A={new:{icon:p.Bell,color:"bg-blue-50 text-blue-700 border-l-blue-500",bgLight:"bg-blue-500",label:"New Order"},confirmed:{icon:l.CheckCircle,color:"bg-amber-50 text-amber-700 border-l-amber-500",bgLight:"bg-amber-500",label:"Confirmed"},packed:{icon:m.Package,color:"bg-purple-50 text-purple-700 border-l-purple-500",bgLight:"bg-purple-500",label:"Packed"},ready:{icon:n.Truck,color:"bg-green-50 text-green-700 border-l-green-500",bgLight:"bg-green-500",label:"Ready"},delivered:{icon:l.CheckCircle,color:"bg-gray-50 text-gray-600 border-l-gray-400",bgLight:"bg-gray-500",label:"Delivered"},cancelled:{icon:o.XCircle,color:"bg-red-50 text-red-700 border-l-red-500",bgLight:"bg-red-500",label:"Cancelled"}},B=["new","confirmed","packed","ready","delivered"];function C({orders:a}){let[l,m]=(0,c.useState)(a),[n,p]=(0,c.useState)("all"),[q,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!0),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(!1),L=(0,c.useRef)(null);(0,d.useRouter)(),(0,c.useEffect)(()=>{K(!0)},[]),(0,c.useEffect)(()=>{m(a)},[a]);let M=async()=>{I(!0);try{let a=(await e.api.orders.getMerchantOrders()||[]).map(a=>({id:a.id,merchant_id:a.merchantId,customer_name:a.customer?.fullName||a.customerName||a.userName||"Customer",customer_phone:a.customer?.phone||a.customerPhone||a.userPhone,customer_address:a.deliveryAddress||a.customer?.address||a.customerAddress,status:a.status?.toLowerCase()||"new",total_amount:a.grandTotal||a.totalAmount||a.total,items:a.items||a.orderItems?.map(a=>({name:a.productName||a.name,quantity:a.quantity,price:a.unitPrice||a.price}))||[],notes:a.deliveryInstructions||a.notes||a.specialInstructions,created_at:a.createdAt||a.orderDate,updated_at:a.updatedAt})),b=new Set(l.map(a=>a.id));a.filter(a=>!b.has(a.id)&&"new"===a.status).length>0&&F&&L.current&&L.current.play().catch(()=>{}),m(a)}catch(a){console.error("Failed to refresh orders:",a)}setTimeout(()=>I(!1),500)};(0,c.useEffect)(()=>{let a=setInterval(M,3e4);return()=>clearInterval(a)},[l,F]);let N=l.filter(a=>"all"===n||a.status===n),O=async(a,b)=>{E(a);try{await e.api.orders.updateStatus(a,b),m(c=>c.map(c=>c.id===a?{...c,status:b}:c)),q?.id===a&&C(a=>a?{...a,status:b}:null)}catch(a){console.error("Failed to update order status:",a),alert("Failed to update order status")}setTimeout(()=>E(null),300)},P=a=>{let b=B.indexOf(a);return b<B.length-1?B[b+1]:null},Q={all:l.length,new:l.filter(a=>"new"===a.status).length,confirmed:l.filter(a=>"confirmed"===a.status).length,packed:l.filter(a=>"packed"===a.status).length,ready:l.filter(a=>"ready"===a.status).length,delivered:l.filter(a=>"delivered"===a.status).length};return(0,b.jsxs)("div",{className:(0,z.cn)("space-y-6 pb-24 lg:pb-6 transition-opacity duration-500",J?"opacity-100":"opacity-0"),children:[(0,b.jsx)("audio",{ref:L,src:"/notification.mp3",preload:"auto"}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Orders"}),(0,b.jsxs)("p",{className:"text-gray-500 mt-1",children:[l.length," total orders"]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",onClick:M,disabled:H,className:"rounded-xl bg-white border-gray-200 hover:bg-gray-50 h-11 touch-active",children:[(0,b.jsx)(x,{className:(0,z.cn)("w-4 h-4 mr-2",H&&"animate-spin")}),"Refresh"]}),(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>G(!F),className:(0,z.cn)("rounded-xl h-11 touch-active",F?"bg-white border-gray-200":"bg-gray-100 border-gray-200"),children:F?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r,{className:"w-4 h-4 mr-2 text-green-600"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Sound On"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Sound Off"})]})})]})]}),(0,b.jsx)("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar pb-1",children:["all","new","confirmed","packed","ready","delivered"].map(a=>{let c=Q[a],d=n===a;return(0,b.jsxs)("button",{onClick:()=>p(a),className:(0,z.cn)("flex items-center gap-2 px-4 py-2.5 rounded-full text-sm font-medium whitespace-nowrap transition-all touch-active",d?"bg-gradient-to-r from-[#FF7F32] to-[#ea580c] text-white shadow-lg shadow-orange-100":"bg-white text-gray-600 border border-gray-200 hover:border-gray-300"),children:[d&&(0,b.jsx)(y.Check,{className:"w-4 h-4"}),"all"===a?"All":A[a]?.label,c>0&&(0,b.jsx)("span",{className:(0,z.cn)("text-xs px-1.5 py-0.5 rounded-full min-w-[20px] text-center",d?"bg-white/20":"new"===a&&c>0?"bg-blue-100 text-blue-700":"bg-gray-100"),children:c})]},a)})}),0===N.length?(0,b.jsxs)(g.Card,{className:"p-8 sm:p-12 bg-white rounded-2xl border-0 shadow-sm text-center",children:[(0,b.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-50 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)(j.ShoppingCart,{className:"w-10 h-10 text-gray-300"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"No orders found"}),(0,b.jsx)("p",{className:"text-gray-500 mt-1 max-w-xs mx-auto",children:"all"===n?"Orders will appear here when customers place them":`No ${A[n]?.label.toLowerCase()} orders`})]}):(0,b.jsx)("div",{className:"space-y-3 stagger-children",children:N.map(a=>{let c,d,e=A[a.status]||A.new,i=e.icon,j=P(a.status),l=D===a.id;return(0,b.jsx)(g.Card,{className:(0,z.cn)("p-4 bg-white rounded-xl border-0 shadow-sm border-l-4 card-hover cursor-pointer touch-active",e.color.split(" ").pop()),onClick:()=>C(a),children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsxs)("span",{className:"font-bold text-gray-900",children:["#",a.id.slice(0,8).toUpperCase()]}),(0,b.jsxs)(h.Badge,{className:(0,z.cn)("rounded-full text-xs font-semibold px-2.5 py-1",e.color.split(" ").slice(0,2).join(" ")),children:[(0,b.jsx)(i,{className:"w-3 h-3 mr-1"}),e.label]}),"new"===a.status&&(0,b.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,b.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),(0,b.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-blue-500"})]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-700 mt-1.5 font-medium",children:a.customer_name}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(k.Clock,{className:"w-3 h-3"}),(c=new Date(a.created_at),(d=Math.floor((new Date().getTime()-c.getTime())/6e4))<1?"Just now":d<60?`${d}m ago`:d<1440?`${Math.floor(d/60)}h ago`:c.toLocaleDateString())]}),(0,b.jsxs)("span",{children:[a.items?.length||0," items"]})]})]}),(0,b.jsxs)("div",{className:"text-right shrink-0",children:[(0,b.jsxs)("p",{className:"font-bold text-gray-900 text-lg",children:["₹",Number(a.total_amount).toLocaleString("en-IN")]}),j&&"cancelled"!==a.status&&(0,b.jsx)(f.Button,{size:"sm",className:(0,z.cn)("mt-2 bg-gradient-to-r from-[#FF7F32] to-[#ea580c] hover:from-[#ea580c] hover:to-[#d95513] text-white rounded-lg text-xs h-8 px-3 shadow-md shadow-orange-100 touch-active",l&&"opacity-70"),onClick:b=>{b.stopPropagation(),O(a.id,j)},disabled:l,children:l?(0,b.jsx)(x,{className:"w-3 h-3 animate-spin"}):(0,b.jsxs)(b.Fragment,{children:[A[j]?.label,(0,b.jsx)(t.ArrowRight,{className:"w-3 h-3 ml-1"})]})})]})]})},a.id)})}),(0,b.jsx)(i.Dialog,{open:!!q,onOpenChange:()=>C(null),children:(0,b.jsx)(i.DialogContent,{className:"max-w-md rounded-2xl mx-4 max-h-[90vh] overflow-y-auto",children:q&&(0,b.jsxs)("div",{className:"animate-slide-up",children:[(0,b.jsxs)(i.DialogHeader,{className:"pb-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(i.DialogTitle,{className:"text-xl",children:["Order #",q.id.slice(0,8).toUpperCase()]}),(0,b.jsx)(h.Badge,{className:(0,z.cn)("rounded-full px-3 py-1",(A[q.status]||A.new).color.split(" ").slice(0,2).join(" ")),children:(A[q.status]||A.new).label})]}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:new Date(q.created_at).toLocaleString()})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 space-y-3",children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900",children:q.customer_name}),q.customer_phone&&(0,b.jsxs)("a",{href:`tel:${q.customer_phone}`,className:"text-sm text-gray-600 flex items-center gap-2 hover:text-[#FF7F32] transition-colors",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)(u.Phone,{className:"w-4 h-4 text-green-600"})}),q.customer_phone]}),q.customer_address&&(0,b.jsxs)("p",{className:"text-sm text-gray-600 flex items-start gap-2",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center shrink-0",children:(0,b.jsx)(v.MapPin,{className:"w-4 h-4 text-blue-600"})}),(0,b.jsx)("span",{className:"pt-1.5",children:q.customer_address})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Order Items"}),(0,b.jsxs)("div",{className:"space-y-2 bg-gray-50 rounded-xl p-4",children:[q.items?.map((a,c)=>(0,b.jsxs)("div",{className:"flex justify-between text-sm py-1",children:[(0,b.jsxs)("span",{className:"text-gray-600",children:[(0,b.jsxs)("span",{className:"font-medium text-gray-900",children:[a.quantity,"x"]})," ",a.name]}),(0,b.jsxs)("span",{className:"font-semibold",children:["₹",(a.price*a.quantity).toLocaleString("en-IN")]})]},c)),(0,b.jsxs)("div",{className:"border-t border-gray-200 pt-3 mt-2 flex justify-between font-bold text-lg",children:[(0,b.jsx)("span",{children:"Total"}),(0,b.jsxs)("span",{className:"text-[#FF7F32]",children:["₹",Number(q.total_amount).toLocaleString("en-IN")]})]})]})]}),q.notes&&(0,b.jsx)("div",{className:"bg-amber-50 border border-amber-100 rounded-xl p-4",children:(0,b.jsxs)("p",{className:"text-sm text-amber-800 flex items-start gap-2",children:[(0,b.jsx)(w.FileText,{className:"w-4 h-4 shrink-0 mt-0.5"}),(0,b.jsx)("span",{className:"font-medium",children:"Note:"})," ",q.notes]})}),"delivered"!==q.status&&"cancelled"!==q.status&&(0,b.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",className:"flex-1 rounded-xl h-12 text-red-600 hover:bg-red-50 bg-white border-gray-200",onClick:()=>O(q.id,"cancelled"),disabled:D===q.id,children:[(0,b.jsx)(o.XCircle,{className:"w-4 h-4 mr-2"}),"Cancel"]}),P(q.status)&&(0,b.jsx)(f.Button,{className:"flex-1 bg-gradient-to-r from-[#FF7F32] to-[#ea580c] hover:from-[#ea580c] hover:to-[#d95513] text-white rounded-xl h-12 shadow-lg shadow-orange-100",onClick:()=>O(q.id,P(q.status)),disabled:D===q.id,children:D===q.id?(0,b.jsx)(x,{className:"w-4 h-4 animate-spin"}):(0,b.jsxs)(b.Fragment,{children:["Mark ",A[P(q.status)]?.label,(0,b.jsx)(t.ArrowRight,{className:"w-4 h-4 ml-2"})]})})]})]})]})})})]})}var D=a.i(7757);function E(){let[a,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(!0),i=(0,d.useRouter)();return((0,c.useEffect)(()=>{(async()=>{let a=(0,e.getToken)(),b=(0,e.getUser)();if(!a||!b)return i.push("/merchant/login");try{let a=(await e.api.orders.getMerchantOrders()||[]).map(a=>({id:a.id,merchant_id:a.merchantId,customer_name:a.customer?.fullName||a.customerName||a.userName||"Customer",customer_phone:a.customer?.phone||a.customerPhone||a.userPhone,customer_address:a.deliveryAddress||a.customer?.address||a.customerAddress,status:a.status?.toLowerCase()||"new",total_amount:a.grandTotal||a.totalAmount||a.total,items:a.items||a.orderItems?.map(a=>({name:a.productName||a.name,quantity:a.quantity,price:a.unitPrice||a.price}))||[],notes:a.deliveryInstructions||a.notes||a.specialInstructions,created_at:a.createdAt||a.orderDate,updated_at:a.updatedAt}));f(a)}catch(a){console.error("Failed to fetch orders:",a)}finally{h(!1)}})()},[i]),g)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)(D.Loader2,{className:"w-8 h-8 animate-spin text-[#FF7F32]"})}):(0,b.jsx)("div",{className:"pb-20 lg:pb-0",children:(0,b.jsx)(C,{orders:a})})}a.s(["default",()=>E],29623)}];

//# sourceMappingURL=Samaan_SamaanMerchant_app_merchant_orders_page_tsx_1f4a8c64._.js.map