(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95776,e=>{"use strict";var t=e.i(93095),s=e.i(61836);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function r({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function l({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...a})}function d({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>i,"CardDescription",()=>d,"CardHeader",()=>r,"CardTitle",()=>l])},25875,e=>{"use strict";let t=(0,e.i(35694).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],25875)},10434,e=>{"use strict";let t=(0,e.i(35694).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],10434)},42898,e=>{"use strict";let t=(0,e.i(35694).default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);e.s(["Sparkles",()=>t],42898)},28679,e=>{"use strict";let t=(0,e.i(35694).default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],28679)},29225,e=>{"use strict";let t=(0,e.i(35694).default)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);e.s(["ArrowUpRight",()=>t],29225)},67819,e=>{"use strict";var t=e.i(93095),s=e.i(60709),a=e.i(94296),r=e.i(44977),l=e.i(16073),d=e.i(88508),i=e.i(35694);let n=(0,i.default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var c=e.i(10434),o=e.i(45340),m=e.i(25875),x=e.i(28679),h=e.i(42898),g=e.i(29225);let u=(0,i.default)("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);var p=e.i(95776),f=e.i(48642),j=e.i(61836);function b({merchant:e,todayOrders:a,weekOrders:i,lowStockProducts:b,pendingOrders:y,allOrders:N,userEmail:w}){let[v,k]=(0,s.useState)(!1);(0,s.useEffect)(()=>{k(!0)},[]);let A=a.reduce((e,t)=>e+Number(t.total_amount),0),_=y.length,C=b.length,S=new Date;S.setDate(S.getDate()-1);let M=S.toISOString().split("T")[0],D=i.filter(e=>e.created_at.startsWith(M)).reduce((e,t)=>e+Number(t.total_amount),0),F=D>0?(A-D)/D*100:0,T={};N.forEach(e=>{e.items&&Array.isArray(e.items)&&e.items.forEach(e=>{T[e.product_id]?T[e.product_id].count+=e.quantity:T[e.product_id]={name:e.name,count:e.quantity}})});let I=Object.values(T).sort((e,t)=>t.count-e.count).slice(0,5),P=Array.from({length:7},(e,t)=>{let s=new Date;return s.setDate(s.getDate()-(6-t)),s.toISOString().split("T")[0]}),L=P.map(e=>i.filter(t=>t.created_at.startsWith(e)).reduce((e,t)=>e+Number(t.total_amount),0)),O=Math.max(...L,1),R={new:"border-l-blue-500 bg-blue-50/50",confirmed:"border-l-amber-500 bg-amber-50/50",packed:"border-l-purple-500 bg-purple-50/50",ready:"border-l-green-500 bg-green-50/50"},U={new:"New",confirmed:"Confirmed",packed:"Packed",ready:"Ready"};return(0,t.jsxs)("div",{className:(0,j.cn)("space-y-6 pb-24 lg:pb-6 transition-opacity duration-500",v?"opacity-100":"opacity-0"),children:[(0,t.jsx)("div",{className:"flex flex-col gap-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Welcome back!"}),(0,t.jsx)("span",{className:"text-2xl",children:"ðŸ‘‹"})]}),(0,t.jsxs)("p",{className:"text-gray-500",children:["Here's what's happening with"," ",(0,t.jsx)("span",{className:"font-medium text-gray-700",children:e?.shop_name||"your shop"})," today."]})]}),(0,t.jsx)(f.Button,{asChild:!0,className:"bg-gradient-to-r from-[#FF7F32] to-[#ea580c] hover:from-[#ea580c] hover:to-[#d95513] text-white rounded-xl shadow-lg shadow-orange-100 h-11 px-5 touch-active",children:(0,t.jsxs)(r.default,{href:"/merchant/products/new",children:[(0,t.jsx)(d.Package,{className:"w-4 h-4 mr-2"}),"Add Product"]})})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 stagger-children",children:[(0,t.jsxs)(p.Card,{className:"p-4 sm:p-5 bg-white rounded-2xl border-0 shadow-sm card-hover",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-100",children:(0,t.jsx)(l.ShoppingCart,{className:"w-6 h-6 text-white"})}),(0,t.jsx)("span",{className:"text-xs font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded-full",children:"Today"})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 animate-count",children:a.length}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Orders"})]})]}),(0,t.jsxs)(p.Card,{className:"p-4 sm:p-5 bg-white rounded-2xl border-0 shadow-sm card-hover",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center shadow-lg shadow-green-100",children:(0,t.jsx)(n,{className:"w-6 h-6 text-white"})}),0!==F&&(0,t.jsxs)("span",{className:(0,j.cn)("text-xs font-medium px-2 py-1 rounded-full flex items-center gap-0.5",F>0?"text-green-600 bg-green-50":"text-red-600 bg-red-50"),children:[F>0?(0,t.jsx)(g.ArrowUpRight,{className:"w-3 h-3"}):(0,t.jsx)(u,{className:"w-3 h-3"}),Math.abs(F).toFixed(0),"%"]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("p",{className:"text-3xl font-bold text-gray-900 animate-count",children:["â‚¹",A.toLocaleString("en-IN")]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Revenue"})]})]}),(0,t.jsxs)(p.Card,{className:"p-4 sm:p-5 bg-white rounded-2xl border-0 shadow-sm card-hover",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-500 to-amber-600 rounded-xl flex items-center justify-center shadow-lg shadow-amber-100",children:(0,t.jsx)(m.Clock,{className:"w-6 h-6 text-white"})}),_>0&&(0,t.jsxs)("span",{className:"relative flex h-3 w-3",children:[(0,t.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),(0,t.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-amber-500"})]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 animate-count",children:_}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Pending"})]})]}),(0,t.jsxs)(p.Card,{className:(0,j.cn)("p-4 sm:p-5 rounded-2xl border-0 shadow-sm card-hover",C>0?"bg-gradient-to-br from-red-50 to-white":"bg-white"),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsx)("div",{className:(0,j.cn)("w-12 h-12 rounded-xl flex items-center justify-center shadow-lg",C>0?"bg-gradient-to-br from-red-500 to-red-600 shadow-red-100":"bg-gradient-to-br from-gray-400 to-gray-500 shadow-gray-100"),children:(0,t.jsx)(c.AlertTriangle,{className:"w-6 h-6 text-white"})}),C>0&&(0,t.jsx)("span",{className:"text-xs font-medium text-red-600 bg-red-100 px-2 py-1 rounded-full",children:"Alert"})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 animate-count",children:C}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Low Stock"})]})]})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Pending Orders"}),_>0&&(0,t.jsxs)("span",{className:"bg-amber-100 text-amber-700 text-xs font-semibold px-2 py-1 rounded-full",children:[_," active"]})]}),(0,t.jsxs)(r.default,{href:"/merchant/orders",className:"text-[#FF7F32] text-sm font-medium hover:underline flex items-center gap-1 group",children:["View all",(0,t.jsx)(x.ArrowRight,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]})]}),0===y.length?(0,t.jsxs)(p.Card,{className:"p-8 sm:p-12 bg-white rounded-2xl border-0 shadow-sm text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-50 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(l.ShoppingCart,{className:"w-10 h-10 text-gray-300"})}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900 text-lg",children:"No pending orders"}),(0,t.jsx)("p",{className:"text-gray-500 mt-1 max-w-xs mx-auto",children:"New orders will appear here. Make sure your shop is open!"})]}):(0,t.jsx)("div",{className:"space-y-3 stagger-children",children:y.slice(0,5).map(e=>{let s,a;return(0,t.jsx)(r.default,{href:`/merchant/orders/${e.id}`,children:(0,t.jsx)(p.Card,{className:(0,j.cn)("p-4 bg-white rounded-xl border-0 shadow-sm border-l-4 card-hover cursor-pointer touch-active",R[e.status]),children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsxs)("span",{className:"font-bold text-gray-900",children:["#",e.id.slice(0,8).toUpperCase()]}),(0,t.jsx)("span",{className:(0,j.cn)("text-xs font-semibold px-2.5 py-1 rounded-full","new"===e.status&&"bg-blue-100 text-blue-700","confirmed"===e.status&&"bg-amber-100 text-amber-700","packed"===e.status&&"bg-purple-100 text-purple-700","ready"===e.status&&"bg-green-100 text-green-700"),children:U[e.status]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1 font-medium",children:e.customer_name}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-0.5",children:(s=new Date(e.created_at),(a=Math.floor((new Date().getTime()-s.getTime())/6e4))<1?"Just now":a<60?`${a}m ago`:a<1440?`${Math.floor(a/60)}h ago`:s.toLocaleDateString())})]}),(0,t.jsxs)("div",{className:"text-right shrink-0",children:[(0,t.jsxs)("p",{className:"font-bold text-gray-900 text-lg",children:["â‚¹",Number(e.total_amount).toLocaleString("en-IN")]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[e.items?.length||0," items"]})]})]})})},e.id)})})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(p.Card,{className:"p-5 bg-white rounded-2xl border-0 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Revenue Trend"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Last 7 days"})]}),(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center shadow-lg shadow-green-100",children:(0,t.jsx)(o.TrendingUp,{className:"w-5 h-5 text-white"})})]}),(0,t.jsx)("div",{className:"flex items-end gap-1.5 h-20",children:L.map((e,s)=>(0,t.jsx)("div",{className:"flex-1 flex flex-col items-center gap-1",children:(0,t.jsx)("div",{className:(0,j.cn)("w-full rounded-t-lg transition-all duration-300",s===L.length-1?"bg-gradient-to-t from-[#FF7F32] to-[#ea580c]":"bg-gradient-to-t from-orange-200 to-orange-100"),style:{height:`${Math.max(e/O*100,4)}%`},title:`â‚¹${e.toFixed(0)}`})},s))}),(0,t.jsx)("div",{className:"flex justify-between mt-3 text-[10px] text-gray-400 font-medium",children:P.map((e,s)=>(0,t.jsx)("span",{children:new Date(e).toLocaleDateString("en-IN",{weekday:"short"}).charAt(0)},s))})]}),(0,t.jsxs)(p.Card,{className:"p-5 bg-white rounded-2xl border-0 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Low Stock"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Items need restocking"})]}),(0,t.jsx)(r.default,{href:"/merchant/products?filter=low-stock",className:"text-[#FF7F32] text-xs font-medium hover:underline",children:"View all"})]}),0===b.length?(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-green-50 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,t.jsx)(h.Sparkles,{className:"w-6 h-6 text-green-500"})}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"All products well stocked!"})]}):(0,t.jsx)("div",{className:"space-y-3",children:b.slice(0,4).map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3 group",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-xl overflow-hidden shrink-0",children:e.image_url?(0,t.jsx)("img",{src:e.image_url||"/placeholder.svg",alt:e.name,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(d.Package,{className:"w-5 h-5 text-gray-400"})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-[#FF7F32] transition-colors",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-red-600 font-semibold",children:[e.stock," left"]})]})]},e.id))})]}),(0,t.jsxs)(p.Card,{className:"p-5 bg-white rounded-2xl border-0 shadow-sm",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Top Selling"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Best performers"})]})}),0===I.length?(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,t.jsx)(o.TrendingUp,{className:"w-6 h-6 text-gray-400"})}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"No sales data yet"})]}):(0,t.jsx)("div",{className:"space-y-3",children:I.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:(0,j.cn)("w-8 h-8 rounded-lg flex items-center justify-center text-xs font-bold",0===s&&"bg-amber-100 text-amber-700",1===s&&"bg-gray-100 text-gray-600",2===s&&"bg-orange-100 text-orange-700",s>2&&"bg-gray-50 text-gray-500"),children:s+1}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[e.count," sold"]})]})]},s))})]})]})]})]})}var y=e.i(74778),N=e.i(63808);function w(){let e=(0,a.useRouter)(),[r,l]=(0,s.useState)(!0),[d,i]=(0,s.useState)(null),[n,c]=(0,s.useState)([]),[o,m]=(0,s.useState)([]),[x,h]=(0,s.useState)([]),[g,u]=(0,s.useState)([]),[p,f]=(0,s.useState)([]),[j,w]=(0,s.useState)("");return((0,s.useEffect)(()=>{(async()=>{try{let t=(0,y.getUser)();if(console.log("[v0] User data from localStorage:",t),!t)return void e.push("/merchant/login");w(t.email||"");let s=t.merchantId||t.merchant_id||t.id;console.log("[v0] Using merchantId:",s);try{let e=await y.merchantsAPI.getById(s);console.log("[v0] Merchant data:",e),i(e)}catch(e){console.log("[v0] Could not fetch merchant data:",e)}try{let e=await y.ordersAPI.getMerchantOrders();console.log("[v0] Orders:",e);let t=new Date;t.setHours(0,0,0,0);let s=(e||[]).filter(e=>new Date(e.createdAt||e.created_at)>=t);c(s);let a=new Date;a.setDate(a.getDate()-7);let r=(e||[]).filter(e=>new Date(e.createdAt||e.created_at)>=a).map(e=>({created_at:e.createdAt||e.created_at,total_amount:e.totalAmount||e.total_amount}));m(r);let l=["new","confirmed","packed","New","Confirmed","Packed"],d=(e||[]).filter(e=>l.includes(e.status)).slice(0,5).map(e=>({...e,id:e.id,status:e.status?.toLowerCase(),customer_name:e.customer?.fullName||e.customerName||e.customer_name,total_amount:e.grandTotal||e.totalAmount||e.total_amount,created_at:e.createdAt||e.created_at,items:e.items||e.orderItems}));u(d),f((e||[]).map(e=>({items:e.items||e.orderItems})))}catch(e){console.log("[v0] Could not fetch orders:",e)}try{let e=await y.productsAPI.getByMerchant(s);console.log("[v0] Products:",e);let t=(e||[]).filter(e=>e.stock<=10&&(e.isActive||e.is_active)).map(e=>({...e,image_url:e.imageUrl||e.image_url,is_active:e.isActive||e.is_active}));h(t)}catch(e){console.log("[v0] Could not fetch products:",e)}}catch(e){console.error("[v0] Error fetching dashboard data:",e)}finally{l(!1)}})()},[e]),r)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(N.Loader2,{className:"w-8 h-8 animate-spin text-[#FF7F32] mx-auto"}),(0,t.jsx)("p",{className:"mt-2 text-gray-500",children:"Loading dashboard..."})]})}):(0,t.jsx)(b,{merchant:d,todayOrders:n,weekOrders:o,lowStockProducts:x,pendingOrders:g,allOrders:p,userEmail:j})}e.s(["default",()=>w],67819)}]);